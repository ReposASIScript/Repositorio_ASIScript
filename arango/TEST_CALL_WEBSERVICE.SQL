--spool TEST_CALL_WEBSERVICE.log
--set serveroutput on size 1000000;

DECLARE
  GV_END_POINT_ADDRESS CLOB;
  GV_WEBSERVICE   CLOB;
  GV_REQUEST      CLOB;
  GV_RESPONSE     CLOB;
  GV_MSGERR       CLOB;

  LV_HTTP_REQUEST      UTL_HTTP.req;
  LV_HTTP_RESPONSE     UTL_HTTP.resp;
  LV_HTTPS             CLOB;
  LV_WR                CLOB;
  LV_WPW               CLOB;
  LN_ERROR             NUMBER;
  LV_XML               CLOB :='hbby9MEU;(CLQih\`kg/g-YSZbnaqf{{H1;;;_;)M4p84D39NK-M5{po5wNC(D(:S5(|@F=A58C.(Of`]YX\O:f[kai[CD:|}1r0wm|y.(O(@5AJ;0L9MNSML@@FFO.):zR9MCKHRIC5EC-6MB9G=5;vyp@6IML;.5P:KGPOQ)s{zH5@MZ=B)6?=15.NEP?[M5O;1(y??PE8Q1;Gz6}:B=8?A{)}}8=)9):C6?OBF(T@GNY)E960H)8.RK?_I7YDNBL)5CA04=.q:n;M0B);y9T@((M@M3MF3NAN3M;@-5MLD(DH;(6S(I?K-s4|3}-U-9;G8|t0NI@2V@(KG7M5L9K{}9O)D.D@)ONKNCQ@=0y))0(()q9{IR=F)569D@I/RH;5@C==;]KBL==CM}y@H)82VDC7;F-EIPBo3wxso2q.9yoFAENL;6p:SO9.LF;VKEX5QB9(;)@K8(MDMSG;X7H?K{4?KC5)5o6};W))F..;KM9.B@=8;IDBF;W2GMJ5C:{z:SO91EMN;6E1LH){z7wJ-9IA..l=TBH2NH;OGI_9K?;)z5DOH(DD;]@H\=M89|0;DA1G-q:{CI0C=.4-CBF.YTH{AG0EGCX-NK5)-25M(6y@QLN(SC?56O-M?O-2)-9lQ)(MB;=l)K)G1EKJYGLY5U1F}};BR@AAM)YH;OBSB=5yMM8(:(p}x;A4B:1y?S)EBEC?9@I=HAFYVGP1AFI;p)BBF(G@L}0B1JN)|0(3MSKo|zF:(FP)}w;BLB9AB;L@PKGN2J.(:@J5;T@)Y=BK8@4M;4CB=4H{.(w;A)8:|0-TKD2QT?7=@D99IND2J(J-RC6m)DRB.SOC.|S-JSR71o9}P(8L)1}}BHO54U@GO?;^IU5K8z)DP59T@)YTF_8D?:(}LS0BE8m4t;KC?C8{;MQC1ODF8=CG1B(WO;9?SLy.-MAC1EEC3yS(8L)(71WF\31KL=D(9y@5K@]1EIPQL6xP)(HL-}q-B@=(NDMM(IS=M697;5KBG1OM)OG7L5Q299yLB21N7p0-@O0JL25/NJD?EM).AAS2F5=:CMAym-UFGAOLC10K-(HB(3\bki[f[nSYj/rYhsQl`aQq:bmsbc5.J/@H@8yy;RM9?O@F`@HVCC?J60o;LBD.RD=G_IC){7-BBM=(E1POO(@3=;()FF=N5R2)0B5-)@):@I9;}?K5NE(S16zM;I)BW9R6nz||5vx0px}yU1JFB`1M=3l4?BIZ9S1Q6}00DFKBSEF9yBC9LACN?.)Dmq/S-O/3R=}8/5OC@AFN8{9M1C;@K2DCp.qzm|.z/]{l)R?E?AeB?J@C9lSAEIP]5F)5o)?O;\5PE=(}(1SLKBPEA50J@F=E(OA5)?q13L;L1MDC/}01B=HA3H:6}Q1I)FMBD8}.zqxtymJ@F)BOCB85o4)R?R5A19/0=-CIO@N4G{75CFKT5Q/.=?spC14L?P45-DHBPO(D--=J)KCBV@D5GgifQgav]{nPS_)n]YmaVee`}prr}sB.(LS_5K=6l;-BIX7H5F}00(DLYGDAM.|3NBHOCN68)3q0Q-A=?68EQ?;z4NGHOCL?}(M;JNBXCK8ukd42?E4?MOEKqfn{cjt|(5I6-g`t4BQjblZj`aE]cYk||C5;4Apen2q`l6/:CF;;8D:Hcd`{qXt4;5KA;8D(Kkfh5ffm{3C(4?vdd2I=8^3C;;;8h(1MeX`6/(D8A0g`t|xfo5}?E(B15F1;jddzq^h;(DI)FCC=9fWqx{cn2/)Q3-pVn{ancd4z3)C01uUn6gk`7/3FF;89I?KtWb;gic5?E(B1BSEFcak|c[`{3@8=5ea`2S5AiE=9A-O(c[n6p@?@=9gVhxvXl|yB5D40=BE=pf`7w\k|AD81-A@C9ugr:c[n7C5P):qenyogiuxx=C(=?k^d4e`n0l258=0CB1(cgm5gjo|@1901@OBAoWq3qmh375EC;fWk5NQL(?n)C0(Rcis|yB?E21uhh|n_`zs/5JC-6@D9pUd8eXp;3@F3-5K39pl`8nXd9B9I0:fa`6apXr|w0B8I;{Wr5gjk5|C5?8/9R9FrWm9cik52?JE17DCLq_d2jXb./I:):w`f87`dc^frPZ^pr_i3K-:rBec][gPq[d2lA5EC)c``9o\kxy13F=@F@((keo;gjs5/@8A@=Q(GfW`8t`ax/289;eam;(_d\lak]pUbXd/;4/kPiccQgQnXh8pG38H?qTq|r\c8zB5I21FN79tU`;pZg5@BF31G@)?tWl|uXk:/(82-tSd43XadfgkX^ls^hp3D1DjLtcf_[^cqn9{/B831vWm|t\k.l188I;MD()k^n{gc`.3BI09=D)Lc^d8gY`4:9D?5c_d4BQibbm`Vd_pPa:99/wMd\iQ\TcZn4p:5J5Agdy5{fl|qC9?0/=@1(g^`4v\xz/4(A;8H(Dcer|uli|B(8(-pab5jvi`|w)5:7;{e`2kZn8}75E3;6Q9Feenyt\kxA@@;-GC5EcVd8cpk5ADI):ear:7l_cio`hbhao^joXkO]]josOXQ[ncn3z(D;4Ape`2vfx9p)5I357N)MpYq/vfs|@B@189D)LtWkxujn30B8B0g^n9vij{}xqlXs8lAEEA1igd8q[d9l(7I4ECL5IwWcxel`:@?G0@5R5Fg^r;gcnx15Q0:fasxxdrm|}{udh4/B?J4:uWq|pXq3pG3F((FD)(gdp;gen2=881-A@D9fal/rih33B8A1cUb/tfqqnymn`u/z)?I@AgSk9ges/}:1J0:;Q5;c^h|pkd7C5D43CK@=cT`2cZ`8/C((1fWr/tfhqv2pkfrytB1D4:vWx:wmd7/38821FT)=uXt|tqn6/B8A17NB(cdo5tht7C5I09cf`8roln|mvwjs/q738A8chh5n\mzt/AL499DCLcT`xjffx(4F@A9L5@cU`|uk`2:1I48rWb.=tsl\]mflolTngnoco\m;m:1908chh9vX`y}:19)/5C5Kgeo|tXc5BB8C-BC?(g_d:gi`/@5(=8qeo;rmk{o34efm9p5EG):gdl|geo/p)5I)1AO5;cfd3dc`829L=(5Q4=rSr5upbxA5EC-far5hra1x-{pkm{pB19;-u_`8gXc5-7)G)09QB=ego|tXq|:B@C9CC5Dcdd9r`qx19E2)gct|seeokrpgjlx3/B(;/qd`@pdd9l:D81-9M5DrWb.qZn3=EE095PEApSd4nfp;33@3-fWa|jednlv-vi`4-1EIA5fal;e_n:t3=G):CK?Kraq2v`l5:5M0:HK1Nkesxo\ox@I9D?sgkxks_-zq/c\k4t(?(B@gT`4iXqzl3CK0.5@=AnSc5o`qx(4F(19MCAnWmzkfgx01I4/qYh{=fmr^a_ip_]^lNXioh\kaj[tdge`zz;?L=)c_n{g\r6l@B86;GR1Fidh|pkn9(?GD09DFAvSq2cj`811;0?vWmxra^{mmxn\mxo3C8;5xSu5o`s3l(3?0:8N==nSryqk`9;9(=@F@C=nUg/slh2:?J):tW`/sp].snxgjt|wB1(B;oab5ufc|x75I3-;Q9Liak6gXm{=((;-A@)Gnar{g[n911P4)q`r5hraqvm.giq4.7)E3;nac|tfi5}33F685DC;qbd:cp`(/):C-AA1DgSm{qdd./3@08ce`2od]qvmut\e8pA3F31nSsxt[dzp@I(;(9Q6MoW`-qYhx2?I31@NCHk`n9o\c/3BF=1p^`zgr]po1{nmh4o==(48uWm:k[n{p:1I4-@H49fdd97tS/FH)`9C.Al1;B;X5C1K}y(5MBK7H1E2{1A5HL?B;7@)s0@:BA2J=LS:4p4N@=T?C;.3DA(LMYIS.pXkxA=8=;G@79tdn:c[`93(E8:q_d9Aanhpk[fej_rUi[oLl^c\Mn:_Pim\Meffd2n/=@=;g`kxqjb;}7483=ID39{d`6k[`33)K409R@Mugd9ggt9=5CB;n^n9)B1k)(M15=e(EKvXaxy:1D0)eZ`2qjbxm/(C)?HQ?Hgl`yceb5((8B(=D4Jcex2qjlxB?IA-nWr2]ui`3lA)FB3q^o|cY`4l:@8B-FX?=uf`ycZn3=5E)@FN=MpVnzqee;(4@3;{Ss|OB0`O=9;5MAqghx07?C4:e[`xii`{p19;)09PE=rWc8qkd815I)1GB1Hcd`6qip;35JC-dSr|cwin{p?E(B5jga/gi`zl74F08GT5Dqkn2g_`y@98B1;T9(qV`4ffb5(5C7-eZ`.;RQ-K]Q1A(Mf\r:}=J8A8qbhzcik5p(@(3-7HDGuUn4nXl/A=8317HCAq`b5pht|3CK0.cVh9lw\r:z/=(C1t^d;pkh8z3)C0/5A5Rckn9gcn7C5;8/9M4=o[c/e\m|(DI4;vd`91[hQpkqTX^l^n]2G-CwMoXmMkUqjg5x0B(B1p_h(k[`3p61E2;@F1(q^`3w\q:34(08;T)GuU`3r\r/(?J=;geu|@PVTpch`feb^](G93rKpfi`Z^kXq|n=)F21t^n6qip;p/(8405CAMgfd4ifd9/C:)?5RC=rgd{gec|19I89rgm|;Qcdbs]\U_`in];ME)xAogX^ZQuk`8p(D(A)cVn4webxs3=8C-8N1MpZn3did?:?D0?7DB;cct|j\d9B1;)0gZ`z3^a_coaVsUaU]?M1BxKe\cTZOjXx3p/28;-pUd9qYq|{34I)@9Q3=tafxtZhx:((6-ANC9nSbxuXc|(?:71oWaxfgkqxm/:FB-oWm:g[d2n/28;8CX39o[m|jXb//(8C1FQ1Rc_d.cYhx=(M80cVn6M}mk-zxqvfc|w(9E)=wWhycXb5x)1E0:8N==raq7w\d4B?;)1@SB9{Wb:qenx0B@)8cTnzgpk-o/{o\r5})B(=0kSk9ges/}?E((1HHB9dSc|nXlx(78(1J@1(cdkxt\b5;@(=?cb`:xojpsy{nfc|-)5;80ggm3cen:lH?E)45XB=eal6gerx)1I08CRDJc[c5t\r7C5;48cf`4:bu@`gf]TkYn7/33L4:vWr2qht|{/CF(1(@C=pfd4f`c55BL=59MDJgSkxeXrxG6L80kddzM[i1ikYONgYd8/(DI03qVd2cYn:p:(8487N)9e_d7w\l5:1)0);@)Lckl|f\u5:F@)-nYn{)]]8ji`cQifl|.3);81pWk9q]`8pA?G;-BC?LqV`(kXl|:1K8-8DCGtVd4c[`33)K41nUn8?4yj5q}/mdXlx}31;)/q`d2ffq9z25C095M?Dk_o/gc`9:1)A5A@CIwWl|tfcx01E?;t^`9sefuvyruXe;p@1HD1fad9v\axy51I255EB=pfdxnXo;3BK0/9QB9fSb5ofx53CK0.c^k5xajpysqtXa/l1(8A-{TkxpZ`2w378A;B@(9eSo/vXkz=)(;85L5FvSa2gXr633K)0gVn9=[i:d]]QMfXrxx01JC1p[`4nXbx}/8@=/(@49nar5lfr8=:FB09K(9pfn?nXq5)18A)wY`{:jk)`c`O^ifu/l85(=@tWmynXmzl;1J316H(IwWr;oXc831G4?5Q4=uWq3wZg5;1J08vSi5O_jEk\gOPcjt9{7B81-fWr6k\q:lGCF;8CY1:cVn8o`cx3)L=85L5Fvah4kes|@BL((kVn7Spnq.rlmpgjc|p:4@00g^`6cch@l)5I)/@@B9pas|p``6/3@4:7H1Hcd`2c[d95B825cVd3udk}.srnck|r/B8;-id`4eXrxo3(84?ET9Fcct|gjsx01M0/=@IDwYtyt\b5;?L=9cgr5rekpowuf`n7/328B@cT`{gck5}7AL4;GXAMg\t3did9?E(4)5G?JcVdxn\f8/BC0BkV`5;fe3jXgcTka`x-33L=0cdkxgekx./B(009B?Fvd`:cim;3FFB?=QFAg`s|uXa87BC)?rar:Bak?ll]bMtc`9-/28=-uct|ela8t/)C)?AT5:nWr2cje;(48B09K1KnSl6ci`9:?J2-pV`{Hm`1gXg^agisx-A1:D0kdd2rfk(zG4(9-FD)LtSq2cct@G5C05FD5Fgen|uk`y/):D-pVn/L0k`w{vmocj`|w7):):hgm{kYk|l@?D009K1Kx[n2gk`9A9CE1GSB=uk`9kjt675I):sgd2gsp-o1tgilxy/CD))cSc(gis/o/CG))@@D=nWoxv``5A9D?89L5FvWo5t\kx45:C;jSa/gnhxo{mffc|07C@C-ugoxtcn:p=6(;5NREKeal6t\rxA4(03I@6JkSr;uZn4AE(;;uWr6Ble@pX`S_{jt|y11EC;pSs;tXkzz(C@6A=DBGpct|nXlx2B(H85G9Bced8ggt975I0:fWkxL]k:olgW[p\r{p:3L4)rax2qjc5w=B(B09K1DoSgxdi`7C5:)9DQ1Jqfq5ug`0/BFB0k\nzE[n-h`fOZffo5}:1M4:vSmxnXr0lC(8BB5B99ukd2lXq{7)(=95Q1FcVn{qec|:1J4?vSs;?-naz/vuyrfr|p@7L8-pVd9plcx-G386-8@CHqdkxug`2==8B:CR5;q_n6w\c|)5EB-tWm2uslmtq-qjr/w368;@c`k5u[h|yB5J(-A@1FqfnynXmz/AL4:CR59ear:wda8/2808pgd(urk/--{f\r{p(D83;fWr;oXc8p1(8A-GD4Aqfh|ogn6/B8C;8NfFw`oxt[d93=8=-ufd4B[h-nXbbUil`9u/EC0?n^d4cjc|yC5M)?D@:9tar?u\gx098717G?)cTq/eXq;(1GA;vWr/L^a(jiWSXce`7/3C(B;ufd4kXd4-CC@C5CL5(kSm:glm/(7(=5CR?EgU`4kjl5?E(;-cXh8F[^-\ccaYqc`8pAAL48gct|fXaxy)5I)1@R9KvWlxt\r;:DFC-BH);q_n{qht|)B(55t[n2Jp/]0xkpqpk`{/@1G)?v[yxefk-l(4F31IM1;k`sxccb;3(C)?9K1Hq`hxufk5)1I0/q_d8.arqmu.rXqxw/CI4Ap[n4gjr5n71C4?7K1JcVd(qcu/=(8E58@1DcU`9c[h5=B;4:c^`zuce{o-mf\lxyB5E4)g^e5ifm9t3=GA19M3=pVh{qpk|29A)=ID89d[`7w\d9B1I?)gb`8:^k?kXfOMn`l|yB1I0Ap`t3gin(l@98189C5@wWr6g[d9/198-DNBIwWk5f\b//1C)?rab5L^e-nZc[Qpq`8z(1C;1iSq9wj`3t5?JA;G@3JwUd9nfr|A@@A5HHCLcek5ukd5A?=)?narx(olAiki`Uuk`9w=CK48gb`:cjk5-419A57@)Lgec|nct(71C)?DDBArSs|v`b5A(FB-fhd4Rt}pp3nqxu\o:t;?;8-narxtkh9./CE4/9R9LcVn9q\m{3C)A-7H1Qg`e/pkn{=CC)?sgd.gbe/.rxo\m:p1?EB@kft/cer;n=BK4/=@B9tWh4cY`|(DI41@K?Keal5we`63AL4:cenykr]{kpxg^q|3A9E35g`s|u\m|-/5G)/5D=Hgl`8qer;A@I899Q?Kk`s|pkn9A5I8;ub`8:]k9pe]QMtjdzz((FB1zfqxv\q8pADI4?MB?EqWk2cXm5B?KDBCREKrdh3gi`92E;0?tWr6)]p;\cc`Ui\m{p:?J(1pe`0gjd9{7B@CA5K5Ksgd8gZhy718C)5U5KfWk6gec;:?F31nSl|L[`1oiYa\ck`9-3(8)EqVdzki`3p(E;)=IDD9nhd@pfd8/)C0?5K=9uVd2qjl;3BK)?sgd(?rk^qzoz{vi`{t;5EB5q`r/pfr/x)(((1BS5Kgdd9f\n:@?J?85M5Lcep;g`m:3)K0.c`d9za^xotqtlmx}3(825q`b5pcn9.3BI8/CK1KrWq5sld6=B(B@5Q8=eZn9f\t4/=8C1t[`/sp]yzpnn\exn7(D4:vWo5f``4n=)=D:8HBKgUn4nXrx(9D0?9R1=zbk/eXb/=):81pfh}B]]1iZU\`qXm/n=(8B(gdn4qkt(z:1D8?A@1;gbsxe`n43)KA1@@CLtWr.gilx(1J(;tSp;)_n-idigOqer|}D1;))cea2cebx07F@0-)D)9cWrxu[t{/CC)?GDB=uVd5vin9)(8=1vSr|Gnn-]Xb^MtXd2w/5E;-o[r3cZ`:p5?I8-8D(9uSm/oXr?(?G)0=@@Gt^n:ces51?D?)g`c|Ppv]/r}u{pXl/p(DF31uglxfid?w=C;495R@Gt[c|pkh}738A8CR5KvSaxolx51EG00cWm2gc].k0{tht|n:1I0?gVd9ges|y29F31@NC9ugm:qjc5;5JC57NC;q`d2rid:3HK)0gct|pain}20xf`6.7DL3(cd`|ncn9w/7I0:7@C9fWkxgjp;7)8A1ET5JkSt4gad819K)0geh8Oca:o\g^MtXlxyB5E4)nSk/oghx33(J4=IHDGfWr;oXc83?9;5;@29cfd4gis;@)FB(gdlxG_j@`jY\XcZnzt(1?0.kSp;gZnzt(1I6)5M?K{kd8dXr6/B808;T)Guhd8flqxAIG4?eSc5(lq0jgU`Mqkq5-4BLC-ukk|e_dxr@98?-F@(9ufq|:sF)D;KKCL89lH?T=_@D)L8:?8@NYGC5;{9)D8QL3D?B:D--AU1((B@GM9=yu1HAAY)H/83B?HOB^5M2cet4-=;^BTRAED);719Cgks5fXu/2BF4?d[`4nfht/}:8F?Subq5r``9;;EAK(;Lg^s/rognxx0IJP9L-PkSm.cda85H@=D?raq9/n`cx}9B@8:Ip^n9rfa83CP=5Aq^`9rXqx)EI82=B1Jug`2oXo|@?(=1uSd6YMK^YNK`SKO\KXNY]\YL_]^Y]Tvobxs5o1obl}}5ryc)J]kiy02zu_s4s6k4F5/e]^to|{yo0\aUSbkf[zk/88L)e|kxyek]kuuejqc`90/781-dgrzcec5-C4(B@=M?Lg`hxplmxCDF(;JH(HtWg/ukn873F2;obqx`qZn4p:@I)0wUs5f\kx-01E31)@C(gbkxvXp;pA5?0.Gc`q5dXc5o197M:SD((DRK)1;Igek5zlV@@T)\?M}6000NHQ5D)J.{/4)CIB.3z?.8_)LRK;6IN{..../////////.//////.////////...//////////.//////////..././////////.///////////////////////////.././..../////////////////////////./////////////////////...////////////////.../////////////////////////./////////././/////./..//////////////////////////////////////////////././/////.////////////////////////////////////./././//////..////////////////../////////////////.//////././////////////////////////////..////////////////./...././/..///////.//////////////////////////////////.///////././/////////////////////////////..///////////////.././//////./////////////////.////////////////.///////././//////////////.//////////////////.////////////////////.///////.////////////////../////////////////.//////...//////.////////////////////////.////////.//////.//////...//////../////////////////////////////////////////.//./////.//////////////////////////./////////.///////././/////../////////////////./////////////////.//////././/////.//////////////////////.//////////.///////////////////.////////////.//////..///////////////////////////////////.//////./////////////////////////////..////////////////////////.//.///////.//.//////////////..//////////////////./////////////.///////////////////////////////////////./////////./////////..../../....//////////.//////////.//////////.///////////..////////.//////////.//////////./...././...//////.//////.//////////.//////////.//////////////////////.//////////.//////////./////////./......//////////.////////////////////.////////////..///////////////////////////////////....//./////.///.......//////////./////////.///////////.///////////.////////////.////////.//////////.////////////.//..//./////.////////////1/.//../////.///./////////////.//..////////////.///.//./////.//////.//////.///./////////.//..///./////////.//..////////////.//..////////.//...///./////.///./////////////.///.////////////.//..//./////.//////.///////.///./////.//..//../////////.///.//./////////.///.////////.//...//../////.///.///./////////.///.//./////////.///.////////.////////./////.//../////.//..//../////////.///.////////////.///.////////.///..//../////.///.///./////////.///.////////////.///.////////./////////.//////.////.///////.///./////.///.//../////////.///.////////////.///.//./////./////////./////.////.///////.///./////.//..///./////////.///.////////////.//..////////./////////.//////.////.///////.///./////.//..///./////////.//..////////////.///.////////./////////./////.////.///////.///./////.///.//../////////.///.//./////////.//..//./////.///..//../////.///.///./////////.//..//./////////.///.////////.////////.///.////////.//./////.///./////.///.///./////////.///.//./////////.//..////////.///........///./////.///.///./////////.//..////////////.///.//./////.//........./////////.//..///./////////.///.////////////.///.////////.///........///./////.///.///./////////.//..////////////.///.////////.///...../..//../////.///./////////////.//..////////////.///.////////.///........///./////.///.//../////////.//..//./////////.//..////////.////////.///.///////.///./////.///.//../////////.//..////////////.///.////////.///.....//.///./////.//..///./////////.///.////////////.///.//./////.///..././..//../////.///./////////////.//..//./////////.///.//./////.//.........//.//////.///.///./////////.///.////////////.///.////////.//......././////////.///.///./////////.///.////////////.//..//./////.//..../.././//./////.///.//../////////.///.//./////////.//..//./////.//./////.///.//////.//./////.//../////.//..///./////////.//..////////////.///.////////.//.........//../////.///.///./////////.//..////////////.///.////////.///.../....//../////.///.//../////////.///.//./////////.//..////////.///.....././////////.//..///./////////.///.////////////.//..////////.///........///./////.//..//../////////.///.//./////////.///.////////.//....../..///./////.///.//../////////.////.//////////./////////..//////////.///////////.////////////.///////////////////.//./////////.///.////////.////////.//.//////.//////.////////.///./////.//..///./////////.///.////////////.///.////////.//////.//////.///.//../////.///.//../////////.//..////////////.///.//./////.///..///./////.//..///./////////.//..////////////.//..////////.//.///.///////.//.//////.//..//../////////.///.////////////.///.////////.//...//../////.///.//../////////.///.//./////////.///.////////.////////./////.///./////.//..///./////////.///.////////////.///.//./////.///..///./////.///.///./////////.///.////////////.///.//./////./////////.//////.////.///////.///./////.///.///./////////.///.////////////.///.////////.//.//////./////.////.///////.//../////.///.///./////////.///.////////////.//..//./////.//.//////.//////.////.///////.///./////.///.//../////////.///.////////////.//..////////.//.//////./////.////.///////.///./////.///.//../////////.//..//./////////.//..//./////.//...//../////.///.///./////////.//..////////////.///.//./////.////.../....//../////.//..///./////////.///.////////////.///.//./////.//...././..///./////.///.///./////////.//..//./////////.//..////////.///........//.//////.///.///./////////.///.//./////////.///.////////./////.//////./////////.///.//../////////.///.////////////.//..//./////.//.//.//////./////////.///.///./////////.///.////////////.//..////////.//.//.//////.//.//////.///.///./////////.///.//./////////.///.////////./////../../..//../////.///.///./////////.///.////////////.//..//./////.///........///./////.///.//../////////.//..////////////.///.////////.///........///./////.//..///./////////.///.//./////////.///.////////./////.//////.//../////.///.//../////////.///.////////////.///.////////.//.//.//////.///./////.//..//../////////.///.////////////.///.////////./////.//////.///./////.///.///./////////.///.//./////////.///.//./////.////.../.....//../////.///.///./////////.//..////////////.///.////////.///..../...//../////.///.//../////////.//..//./////////.//..////////.///......../////////.//..///./////////.///.////////////.//..////////./////.//////.//.//////.//..//.//////////.///.////////////.//..////////./////.//////./////////.//..///./////////.///.////////////.///.////////.//.//.//////.//.//////.///.///./////////.///.////////////.//..//./////./////........//../////.//..//../////////.///.////////////.///.////////.///..././..//../////.///.///./////////.//..////////////.///.//./////.///........//.//////.//..///./////////.///.//./////////.///.////////./////.//////.//../////.///.//../////////.//..//./////////.///.////////.//.//.//////.//../////.///.///./////////.//..////////////.///.////////.//.//.//////.///./////.//..///./////////.///.//./////////.//..//./////./////.../....//../////.///.//.//////////.//..////////////.///.//./////.///.....././//./////.///.//../////////.//..//./////////.///.////////.///...///..//../////.///.///./////////.//..//////////././/..////////./////.//////.///./////.///.//../////////.///.//./////////.///.////////./////.//////./////////.///./////////////.///.////////////.///.////////./////.//////.///./////.//..//../////////.//..////////////.//..//./////.////././.....//.//////.//..///./////////.//..////////////.//..////////.////....././/../////.///.///./////////.///.////////////.///.////////.//....../..//../////.///.///./////////.//..//./////////.///.////////./////.//////.//../////.///.///./////////.///.////////////.///.////////./////.//////.///./////.///.///./////////.///.//./////////.///.////////.//.//.//////.///./////.///./////////////.//..////////////.//..////////.////..../....///./////.//../////////////.///.//./////////.///.//./////.///...//...///./////.///.///./////////.///.//./////////.///.////////.//.........//.//////.//..//.//////////.///.////////////.//..////////./////.//////.//../////.//..///./////////.///.////////////.///.////////./////.//////.//../////.///.///./////////.///.//./////////.///.////////.//.//.//////./////////.//..///./////////.///.////////////.///.////////.////.........//../////.///.///./////////.///.////////////.///.////////.///........//../////.///./////////////.///.////////////.///.////////.///........//../////.///.///./////////.///.//./////////.///.////////.//.//.//////.///./////.///.///./////////.//..////////////.///.//./////./////.//////.//../////.///.//.//////////.//..//./////////.///.////////.//.//.//////.///./////.///.///./////////.///.////////////.///.////////.//./.../.....///./////.//..///./////////.//..//./////////.//..////////.///..././..//../////.///.//../////////.///.////////////.///.////////.//......//./////////.//..///./////////.//..////////////.///.////////./////.//////.//../////.///.//.//////////.///.////////////.///.////////.//.//.//////.//../////.///.//../////////.///.////////////.///.//./////./////.//////./////////.//..//../////////.//././/////////.////////////////////./////////////////////////..///////////////////.///////////////////.///.////////.///..///./////.///.///////////.///..//..////////.///./////////.////.//..//////.///./////////.///.//./////////.///.//./////.////////////////////////////////../././/../...//.//.//...././/////.//.....//////////../////....../././././////////.//../////////////.//..//./////////.///.////////.//...///./////.///.//.//////////.//..///.//////.///.///.////////////////.///..////////.////////////.////////.////////////.';
BEGIN
  --verifica si el sitio del ws tiene seguridad https
  MG_K_PARAMETROS_DINAMICOS.MG_P_DEVUELVE_VALOR('BMG','HTTPS_ABANKSGX',LV_HTTPS,GV_MSGERR);

  IF LV_HTTPS = 'S' THEN
    --obtiene parametros de seguridad https
    MG_K_PARAMETROS_DINAMICOS.MG_P_DEVUELVE_VALOR('BMG','WR_ABANKSGX',LV_WR,GV_MSGERR);
    IF GV_MSGERR IS NOT NULL THEN
      RETURN;
    END IF;
    MG_K_PARAMETROS_DINAMICOS.MG_P_DEVUELVE_VALOR('BMG','WPW_ABANKSGX',LV_WPW,GV_MSGERR);
    IF GV_MSGERR IS NOT NULL THEN
      RETURN;
    END IF;
    LV_WR := 'file:'||LV_WR;
    utl_http.set_wallet(LV_WR,LV_WPW);
  END IF;

    GV_REQUEST := '<?xml version="1.0" encoding="iso-8859-1"?>
      <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope" xmlns:q0="Abanksgx" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <soapenv:Body>
          <q0:APCOPE11029.Execute>
            <q0:Plv_xmlin>'||LV_XML||
            '</q0:Plv_xmlin>
          </q0:APCOPE11029.Execute>
        </soapenv:Body>
      </soapenv:Envelope>';

    -- obtiene url del webservice
    GV_END_POINT_ADDRESS := MG_K_PARAMETROS_DINAMICOS.MG_F_DEVUELVE_VALOR ('BMG','URL_FORM_ABANKSGX');
    GV_END_POINT_ADDRESS := GV_END_POINT_ADDRESS||'apcope11029'; -- url + nombre del websservice en minusculas
    GV_WEBSERVICE        := 'Abanksgxaction/APCOPE11029';        -- nombre del webservice
  
  dbms_output.put_line('GV_WEBSERVICE:' || GV_WEBSERVICE);  
  dbms_output.put_line('GV_END_POINT_ADDRESS:' || GV_END_POINT_ADDRESS);   
  dbms_output.put_line('Length of Request:' || length(GV_REQUEST));
  dbms_output.put_line('Request: ' || GV_REQUEST);
 
  LV_HTTP_REQUEST := utl_http.begin_request(GV_END_POINT_ADDRESS,
                                              'POST',
                                              utl_http.HTTP_VERSION_1_1);
  utl_http.set_header(LV_HTTP_REQUEST,
                      'Content-Type',
                      'text/xml; charset=iso-8859-1');
  utl_http.set_header(LV_HTTP_REQUEST,
                      'Content-Length',
                      length(GV_REQUEST));
  utl_http.set_header(LV_HTTP_REQUEST,
                      'SOAPAction',
                      'Abanksgxaction/'||GV_WEBSERVICE||'.Execute');
  utl_http.write_text(LV_HTTP_REQUEST, GV_REQUEST);

  dbms_output.put_line('');

  LV_HTTP_RESPONSE := utl_http.get_response(LV_HTTP_REQUEST);

  dbms_output.put_line('Response Received');
  dbms_output.put_line('--------------------------');
  dbms_output.put_line('Status code: ' || LV_HTTP_RESPONSE.status_code);
  dbms_output.put_line('Reason phrase: ' ||
                         LV_HTTP_RESPONSE.reason_phrase);

  utl_http.read_text(LV_HTTP_RESPONSE, GV_RESPONSE);
  dbms_output.put_line('Response: ');
  dbms_output.put_line(GV_RESPONSE);

  --verifica si ha ocurrido un error al llamar al webservice
  --los codigos de estado mayores o iguales a 400 correponden a errores
  LN_ERROR := LV_HTTP_RESPONSE.status_code;
 
  IF LV_HTTP_RESPONSE.status_code >= 400 THEN
    GV_MSGERR := mg_k_ctrl_error.mg_f_armar_codigo_error('00000', 'NU_P_GX_CALL_WEBSERVICE','Error: '||LN_ERROR
    ||', URL: '||GV_END_POINT_ADDRESS||' ');     
  END IF;

  utl_http.end_response(LV_HTTP_RESPONSE);
  
EXCEPTION
  WHEN OTHERS THEN
    dbms_output.put_line(SQLERRM);
    dbms_output.put_line(UTL_HTTP.GET_DETAILED_SQLERRM);
    GV_MSGERR := mg_k_ctrl_error.mg_f_armar_codigo_error('00000', 'NU_P_GX_CALL_WEBSERVICE',SQLERRM||' '||UTL_HTTP.GET_DETAILED_SQLERRM);

END;
/
--spool off